<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.youngkbt.generic.base.mapper.UserProjectMapper">

    <resultMap id = "baseResultMap" type = "cn.youngkbt.generic.base.model.GenericProject">
        <id column = "id" property = "id" />
        <result column = "project_name" property = "projectName" />
        <result column = "base_url" property = "baseUrl" />
        <result column = "description" property = "description" />
        <result column = "secret_key" property = "secretKey" />
        <result column = "database_name" property = "databaseName" />
        <result column = "create_user" property = "createUser" />
        <result column = "create_time" property = "createTime" />
        <result column = "modify_user" property = "modifyUser" />
        <result column = "modify_time" property = "modifyTime" />
    </resultMap>

    <sql id = "baseColumnList">
        id, project_name, base_url, description, secret_key, database_name, 
		create_user, create_time, modify_user, modify_time
    </sql>


    <select id="queryGenericProjectListOwner" parameterType = "string" resultMap = "baseResultMap">
        select
            <include refid = "baseColumnList" />
            from generic_project gp where gp.id in (select project_id from user_project up where username = #{username})
    </select>

    <insert id = "insertUserProject" parameterType = "cn.youngkbt.generic.base.model.UserProject">
        insert into user_project
        <trim prefix = "(" suffix = ")" suffixOverrides = ",">
            <if test = "username!= null">
                username,
            </if>
            <if test = "projectId!= null">
                project_id,
            </if>
            <if test = "roleId!= null">
                role_id,
            </if>
            <if test = "type!= null">
                type,
            </if>
        </trim>
        <trim prefix = "values (" suffix = ")" suffixOverrides = ",">
            <if test = "username != null">
                #{username},
            </if>
            <if test = "projectId != null">
                #{projectId},
            </if>
            <if test = "roleId != null">
                #{roleId},
            </if>
            <if test = "type != null">
                #{type},
            </if>
        </trim>
    </insert>
</mapper>